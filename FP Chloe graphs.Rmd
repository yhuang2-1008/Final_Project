---
title: "FP Chloe graphs"
date: "3/3/2021"
output: html_document
theme: cerulean
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning=FALSE)
```

```{r libraries}
library(tidyverse)    
library(lubridate)    
library(openintro)     
library(maps)          
library(ggmap)         
library(gplots)       
library(RColorBrewer)  
library(sf)            
library(leaflet)       
library(ggthemes)      
library(plotly)        
library(gganimate)    
library(transformr)    
library(gifski)        
library(shiny)         
library(ggimage)
library(tidytuesdayR)
theme_set(theme_minimal())
```

```{r, echo=FALSE}
# College Tuition Data
tuition_cost <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-10/tuition_cost.csv')
tuition_income <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-10/tuition_income.csv') 
salary_potential <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-10/salary_potential.csv')
## Including Plots
historical_tuition <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-10/historical_tuition.csv')


# Wealth and Income Over Time
lifetime_earn <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/lifetime_earn.csv')
student_debt <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/student_debt.csv')
retirement <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/retirement.csv')
home_owner <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/home_owner.csv')
race_wealth <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/race_wealth.csv')
income_time <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/income_time.csv')
income_limits <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/income_limits.csv')
income_aggregate <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/income_aggregate.csv')
income_distribution <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/income_distribution.csv')
income_mean <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/income_mean.csv')
```

##graph showing tuition_cost (in_state_total and out_state_total) VS salary_potential (mid_career_pay) by state or uni

```{r}
college_potential <- tuition_cost %>% 
  mutate(state_name = state) %>% 
  left_join(salary_potential, by = c("state_name", "name")) %>% 
  mutate(state_name = str_to_lower(state_name)) 
  
states_map <- map_data("state")

college_potential %>%  
  ggplot() +
  geom_map(map = states_map,
           aes(map_id = state_name,
               fill = in_state_tuition)) +
    expand_limits(x = states_map$long, y = states_map$lat) + 
   scale_fill_viridis_c(option = "inferno") +
    labs(title = "Title blah",
       caption = "Author : Chloe Nance",
       fill = "") +
  facet_wrap(vars(type)) +
  theme_map() 
  
```



```{r}
tuition <- tuition_cost %>% 
 ggplot() +
  geom_boxplot(aes(x = in_state_total, color = "blue")) +
  geom_boxplot(aes(x = out_of_state_total, color = "red")) +
  theme()

debt <- student_debt %>% 
  ggplot(aes(x = year, y = loan_debt)) +
  geom_line() +
  facet_wrap(~race)

tuition/debt
```

