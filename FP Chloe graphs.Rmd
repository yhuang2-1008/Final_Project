---
title: "FP Chloe graphs"
date: "3/3/2021"
output: html_document
theme: cerulean
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning=FALSE)
```

```{r libraries}
library(tidyverse)    
library(lubridate)    
library(openintro)     
library(maps)          
library(ggmap)         
library(gplots)       
library(RColorBrewer)  
library(sf)            
library(leaflet)       
library(ggthemes)      
library(plotly)        
library(gganimate)    
library(transformr)    
library(gifski)        
library(shiny)         
library(ggimage)
library(tidytuesdayR)
theme_set(theme_minimal())
```

```{r, echo=FALSE}
# College Tuition Data
tuition_cost <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-10/tuition_cost.csv')
tuition_income <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-10/tuition_income.csv') 
salary_potential <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-10/salary_potential.csv')
diversity_school <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-10/diversity_school.csv')
## Including Plots
historical_tuition <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-10/historical_tuition.csv')


# Wealth and Income Over Time
lifetime_earn <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/lifetime_earn.csv')
student_debt <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/student_debt.csv')
retirement <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/retirement.csv')
home_owner <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/home_owner.csv')
race_wealth <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/race_wealth.csv')
income_time <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/income_time.csv')
income_limits <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/income_limits.csv')
income_aggregate <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/income_aggregate.csv')
income_distribution <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/income_distribution.csv')
income_mean <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/income_mean.csv')
```

```{r}
states_map <- map_data("state")

tuition_cost %>%
  mutate(state = str_to_lower(state)) %>%
  mutate(in_state_avg = in_state_total/n()) %>% 
  ggplot() +
  geom_map(map = states_map,
           aes(map_id = state,
               fill = in_state_avg)) +
    expand_limits(x = states_map$long, y = states_map$lat) + 
   scale_fill_viridis_c(option = "inferno") +
    labs(title = "Title",
       caption = "Author : Chloe Nance") +
  theme_map() +
  theme()
```
```{r}
tuition_cost %>% 
  filter(type %in% c("Private", "Public")) %>% 
  ggplot(aes(y = in_state_total, fill = type)) +
  scale_y_continuous(labels=scales::dollar_format()) +
  geom_histogram() +
  labs(title = "Range of In State Tuition",
       caption = "Author : Chloe Nance",
       x ="",
       y ="") +
   theme(plot.title = element_text(face = "bold", hjust = .5, size = 15),
        plot.caption = element_text(face = "bold", size = 9),
        legend.title = element_text(face = "bold"),
        axis.text = element_text(color = "black", face = "italic"))
```
```{r}
tuition_cost %>% 
  filter(type %in% c("Private", "Public")) %>% 
  ggplot(aes(y = out_of_state_total, fill = type)) +
  scale_y_continuous(labels=scales::dollar_format()) +
  geom_histogram() +
  labs(title = "Range of Out of State Tuition",
       caption = "Author : Chloe Nance",
       x ="",
       y ="") +
   theme(plot.title = element_text(face = "bold", hjust = .5, size = 15),
        plot.caption = element_text(face = "bold", size = 9),
        legend.title = element_text(face = "bold"),
        axis.text = element_text(color = "black", face = "italic"))
```


```{r}
debt <- student_debt %>% 
  ggplot(aes(x = year, y = loan_debt)) +
  scale_y_continuous(labels=scales::dollar_format()) +
  geom_line() +
  labs(title = "Student loan debt per racial group",
       caption = "Author : Chloe Nance",
       x ="",
       y ="") +
  facet_wrap(~race) +
    theme(plot.title = element_text(face = "bold", hjust = .5, size = 15),
        plot.caption = element_text(face = "bold", size = 9),
        legend.title = element_text(face = "bold"),
        axis.text = element_text(color = "black", face = "italic"))

debt
```


```{r}
states_map <- map_data("state")

options(scipen=10000)

diversity_school %>%
  mutate(state = str_to_lower(state)) %>% 
  group_by(state) %>% 
  ggplot() +
  geom_map(map = states_map,
           aes(map_id = state,
               fill = enrollment)) +
    expand_limits(x = states_map$long, y = states_map$lat) + 
   scale_fill_viridis_c(option = "inferno") +
    labs(title = "Diversity enrollment in US colleges",
       caption = "Author : Chloe Nance",
       fill = "Enrollment") +
  facet_wrap(~category) +
  theme_map() +
  theme(plot.title = element_text(face = "bold", hjust = .5, size = 15),
        plot.caption = element_text(face = "bold", size = 9),
        legend.title = element_text(face = "bold"),
        legend.box.background = element_rect(),
        legend.box.margin = margin(6, 6, 6, 6),
        legend.position = "right")
```
