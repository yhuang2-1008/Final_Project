---
title: "Blog post template"
author: "Cynthia Aguilar, Jennifer Huang, Chloe Nance, Kate Seeger"
date: "3/5/2021"
output: 
  html_document:
    toc: TRUE
    toc_float: TRUE
    df_print: paged
    code_download: true
    theme: journal
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning=FALSE)
```

```{r, echo = FALSE}
library(tidyverse)    
library(lubridate)    
library(openintro)     
library(maps)          
library(ggmap)         
library(gplots)       
library(RColorBrewer)  
library(sf)            
library(leaflet)       
library(ggthemes)      
library(plotly)        
library(gganimate)    
library(transformr)    
library(gifski)        
library(shiny)         
library(ggimage)
library(tidytuesdayR)
library(patchwork)
```

```{r, echo=FALSE}
# College Tuition Data
tuition_cost <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-10/tuition_cost.csv')

tuition_income <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-10/tuition_income.csv') 

salary_potential <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-10/salary_potential.csv')

historical_tuition <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-10/historical_tuition.csv')

diversity_school <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-10/diversity_school.csv')


# Wealth and Income Over Time
lifetime_earn <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/lifetime_earn.csv')
student_debt <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/student_debt.csv')
retirement <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/retirement.csv')
home_owner <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/home_owner.csv')
race_wealth <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/race_wealth.csv')
income_time <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/income_time.csv')
income_limits <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/income_limits.csv')
income_aggregate <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/income_aggregate.csv')
income_distribution <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/income_distribution.csv')
income_mean <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/income_mean.csv')
```


## First Heading

```{r, echo = FALSE}
debtplot <- student_debt %>%
  ggplot(aes(x = year,
             y = loan_debt, 
             fill = race)) + 
  geom_area(alpha = 0.8) +
  labs(title = "Student loan debt by racial groups",
       x= "",
       y ="") + 
  theme_fivethirtyeight() +
  facet_wrap(~ race)


compplot <- diversity_school %>%
  filter(category %in% c("Black", 
                         "Hispanic", 
                         "White")) %>%
  group_by(name,
           category) %>%
  summarize(percent = enrollment/total_enrollment) %>%
  ggplot(aes(x = category,
             y = percent, 
             fill = category)) + 
  geom_boxplot() + 
  labs(title = "Average proportion of student enrollment based on racial group", 
       x = "",
       y= "")


debtplot/compplot
```

Proin sed dignissim ex. Pellentesque volutpat rutrum nisl, quis faucibus nibh maximus sed. Praesent non nisl id velit euismod vulputate in sit amet mauris. Donec vitae nisi eu magna tempor iaculis. Praesent placerat enim quis pulvinar cursus. Vestibulum malesuada magna felis, eget ullamcorper ante maximus pretium. Ut a hendrerit mi. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Donec fermentum nisl vitae diam vulputate ullamcorper. Aliquam eu augue placerat, placerat augue quis, aliquet mi. Donec tristique, enim a mattis finibus, massa ipsum gravida magna, id pellentesque velit nulla eu nibh. Aliquam neque purus, bibendum vel fringilla vel, commodo quis ex. Duis sit amet diam turpis. Duis imperdiet metus dignissim, luctus nisl ornare, malesuada ex. Nulla convallis mi eu ex fringilla porta. 

## Second Heading

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla tempus efficitur volutpat. Suspendisse sollicitudin ligula augue. Curabitur non eros elit. Nullam id odio vel eros facilisis rhoncus et a urna. Mauris tristique convallis felis laoreet pellentesque. Maecenas eget arcu venenatis, sollicitudin est in, pretium nulla. Sed feugiat, nibh sed laoreet mollis, dolor diam euismod turpis, at luctus massa risus vel sapien. Maecenas volutpat turpis sit amet sem faucibus ultricies. In urna nulla, dapibus nec congue et, facilisis nec nunc. Curabitur viverra, massa ac porta porta, neque neque sollicitudin sapien, et sollicitudin neque eros vel ligula. Pellentesque euismod metus quis augue ornare, vel egestas nunc iaculis. Aenean lacus leo, sollicitudin aliquet efficitur eu, molestie ac massa. In id maximus nibh. Vestibulum cursus tincidunt sem, eget fermentum libero laoreet molestie. Ut sed pellentesque mi. 

```{r, echo=FALSE}
race_wealth %>%   
  filter(year >= "1989", race !="Non-White",type=="Median") %>% 
  left_join(retirement, by =c("race","year")) %>% 
  ggplot(aes(x= year,
             y= retirement,
             fill=race))+
  geom_histogram(stat = "identity")+
  geom_line(aes(y=wealth_family))+
  scale_x_continuous(limits = c(1989,2017), expand = c(0, 0)) +
  scale_y_continuous(limits = c(0,200000), expand = c(0, 0),labels=scales::dollar_format())+
  scale_fill_manual(values = c("#6941e1","#4169e1", "#41b9e1"))+
  labs(title = "Average Family Liquid Retirement Savings from 1986-2016",
       caption = "*Line represents median family wealth",
       x="",
       y="")+
  theme(plot.title.position = "plot",
        legend.position = "none",
        panel.border = element_blank(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        axis.line = element_line(color = "black"),
        axis.ticks = element_line(color = 'black')) +
  facet_wrap(vars(race))
```

Donec ullamcorper, mi vel hendrerit lacinia, mauris elit malesuada est, vitae tincidunt sem mi vel velit. Cras eu nulla id felis mollis tincidunt. Nullam nulla neque, mollis eu condimentum sed, pellentesque quis urna. Aenean blandit massa ut varius vestibulum. Aenean dictum eros id risus tristique, quis congue sapien porta. Fusce euismod felis nec pretium iaculis. Phasellus id elit sed nunc pulvinar tempor. Suspendisse potenti.

Sed id nisi arcu. Vivamus viverra rutrum libero, sed dictum leo consectetur sit amet. Ut blandit tristique purus id convallis. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Sed imperdiet ante in diam hendrerit varius. Mauris tincidunt orci libero, in bibendum lacus iaculis sit amet. Ut feugiat felis id imperdiet lobortis. Donec eu laoreet ex, ac ultricies erat. Vestibulum ante nulla, convallis ac metus sit amet, posuere fringilla sapien. 

```{r, echo=FALSE}
tuition <- tuition_cost %>% 
 ggplot() +
  geom_density(aes(x = in_state_total, fill = "blue")) +
  geom_density(aes(x = out_of_state_total, fill = "red")) +
  theme()

debt <- student_debt %>% 
  ggplot(aes(x = year, y = loan_debt)) +
  geom_line() +
  facet_wrap(~race)

tuition/debt
```
Quisque ultricies scelerisque turpis, vitae fringilla mauris condimentum quis. Orci varius natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Pellentesque sodales vulputate ultrices. Maecenas dapibus, sem interdum ornare tempor, risus ligula pulvinar lectus, eget rutrum nulla diam a velit. Phasellus ac iaculis ligula, a convallis tortor. Donec pharetra dui sit amet ex commodo dapibus. Morbi eget laoreet erat. Morbi purus magna, blandit sit amet placerat vitae, aliquet id lectus. Aliquam ultrices magna lectus, vel vestibulum magna luctus non. Suspendisse eu ante at augue ornare porttitor. Sed facilisis, magna venenatis hendrerit molestie, nisl massa iaculis lorem, ac pretium est lectus lacinia risus.


```{r}
income_limits %>%  
  left_join(income_time, by =c("year")) %>% 
  filter(race %in% c("White Alone", "Black Alone", "Hispanic")) %>% 
  mutate(ordered = fct_reorder(income_quintile,
                               income_dollars,
                               .desc = FALSE)) %>% 
  ggplot() +
  geom_boxplot(aes(x = ordered,
             y = income_dollars,
             fill = race)) + 
  scale_y_continuous(limits = c(0,200000), expand = c(0, 0),labels=scales::dollar_format()) + 
  labs(title = "Income limits based on racial groups",
       x = "",
       y = "",
       fill = "Race") + 
  scale_fill_manual(values = c("#40E0D0","#6495ED", "#9370DB"))
```



Referring to Kate's patchwork graphs on student loan debt and enrollment based on racial groups, this graph shows that even though White students have a higher enrollment rate and have roughly the same amount of student loan debt, they nonetheless have significantly higher retirement savings. This is likely due to the wage gap in racial groups and the employment rate for people of color in higher paying positions. 

```{r}
student_debt %>%  
  left_join(retirement, by =c("race", "year")) %>% 
  ggplot() +
  geom_line(aes(x = loan_debt,
             y = retirement,
             color = race)) + 
  scale_color_manual(values = c("#40E0D0","#6495ED", "#9370DB")) + 
  labs(title = "Average Retirement Savings Based on Student Loan Debt",
       x = "Loan Debt",
       y = "Retirement Savings",
       color = "Race") 
```

